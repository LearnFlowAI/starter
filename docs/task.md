# Starter 完整任务清单

评审/生成日期：2026-01-12
最后更新：2026-01-13

> 目标：完成「计时 → 记录 → 积分 → 总览」MVP 闭环，并具备可扩展的迭代基础。

## 进度总览
- **核心功能**: 80% 完成 (MVP 闭环基本可用)
- **工程质量**: 70% 完成 (测试与文档待加强)
- **PWA 支持**: 90% 完成 (manifest + sw.js 已实现)
- **扩展能力**: 20% 完成 (配置/标签/提醒待开发)

---

## 0. 基础与工程
- [x] 明确 MVP 范围与验收标准（功能、数据、页面、可用性）
- [x] 设定版本号与里程碑节奏（当前 v1.1，见 README）
- [x] 统一分支与提交规范（已配置 Husky + GitHub Actions）
- [ ] 建立 issue/任务模板（轻量、可追踪）

## 1. 信息架构与数据模型
### 数据模型
- [x] 定义核心实体：Task、RecordEntry、SessionEntry、ScoreEntry
- [x] 定义完整字段结构（id, title, subject, minutes, rating, points 等）
- [x] 实现基础状态管理（todo/doing/done）
- [ ] 编写状态机文档（状态转换规则与约束）
- [x] 设计积分规则（时长基础分 + 暂停惩罚）
- [ ] 扩展积分规则（质量加成、连续性奖励、书写质量等）
- [x] 时间策略：使用本地时间 + ISO 8601 格式

### 数据持久化
- [x] 实现 useLocalState hook（localStorage 读写）
- [x] 异常处理兜底（safeParse with fallback）
- [x] localStorage key 命名规范（lf_ 前缀）
- [ ] 数据版本迁移策略文档
- [ ] 实现通用 CRUD 存储层（可选优化）
- [ ] 实现数据导入/导出（JSON）
- [ ] 添加数据备份/恢复功能

### 页面与路由
- [x] 首页：MVP 入口（app/page.tsx）
- [x] 任务页：创建/编辑/列表/状态切换（app/tasks/page.tsx）
- [x] 计时页：开始/暂停/结束，自动保存 Session 和 Score（app/timer/page.tsx）
- [x] 记录页：历史记录列表与详情表单（app/record/page.tsx）
- [x] 总览页：每日汇总、积分趋势、本周数据可视化（app/overview/page.tsx）
- [x] 顶部导航：跨页一致性导航（TopNav 组件）
- [ ] 计时器自动保存到记录页（当前需手动点击"结束并重置"）

## 2. 核心业务逻辑
### 积分计算
- [x] 实现基础积分计算（calculateSessionPoints）
  - ✅ 时长基础分：每分钟 5 分
  - ✅ 暂停惩罚：每次暂停 -2 分
  - ✅ 最低保底：1 分
- [ ] 扩展积分规则（参考 RecordEntry 字段）
  - [ ] 质量评分加成（rating 1-5）
  - [ ] 错题惩罚（mistakeCount）
  - [ ] 书写质量加成（writingStars 0-3）
  - [ ] 学习习惯奖励（复习/订正/预习）

### 每日汇总
- [x] 实现 createDailySummaries（聚合 sessions + scores）
- [x] 实现 buildWeeklyTrend（生成 7 天趋势数据）
- [x] 日期格式化工具（formatDate）
- [ ] 周/月统计维度扩展

---

## 3. UI/UX 细化
### 视觉设计
- [x] 主视觉基线（Tailwind + 自定义 CSS 变量）
- [x] 统一组件样式（按钮、卡片、表单、badge）
- [x] 响应式布局（max-w-5xl 容器 + grid-overlay）
- [ ] 移动端适配优化（触摸目标、间距调整）

### 交互状态
- [ ] 空状态设计（无任务、无记录、无数据时的引导）
- [ ] 加载态设计（数据加载中的骨架屏/spinner）
- [ ] 错误态设计（网络错误、数据异常的提示）
- [ ] 成功/失败反馈（toast/snackbar）

### 动效与体验
- [ ] 页面切换动效
- [ ] 列表项新增/删除动效
- [ ] 按钮点击反馈（已有 hover 效果）
- [ ] 计时器数字跳动动效（可选）

---

## 4. PWA 与离线体验
- [x] manifest.json 配置完善
  - ✅ 应用名称、短名称、描述
  - ✅ 主题色、背景色
  - ✅ 图标配置（SVG）
  - ✅ standalone 模式
- [x] Service Worker 基础实现（public/sw.js）
- [ ] 离线可用性测试
  - [ ] 首次访问离线缓存验证
  - [ ] 二次访问离线可用性验证
  - [ ] localStorage 数据持久化验证
- [ ] 安装提示与引导（可选）
- [ ] 更新通知机制（可选）

---

## 5. 数据统计与可视化
- [x] 每日汇总数据（总时长、总积分、会话数）
- [x] 7 天趋势折线图（基础可视化）
- [x] 本周统计卡片（总览页）
- [x] 实际专注分布按 `lf_sessions` 累计
- [ ] 扩展统计维度
  - [ ] 周统计（7 天 → 4 周）
  - [ ] 月统计（30 天）
  - [ ] 按科目/标签分组统计
- [ ] 图表优化
  - [ ] 交互式图表（tooltip、hover）
  - [ ] 图表库集成（recharts/visx）

---

## 6. 测试与质量保障
### 单元测试
- [x] lib/storage.ts 测试（useLocalState, safeParse, uid）
- [x] lib/scoring.ts 测试（calculateSessionPoints 边界条件）
- [x] lib/daily.ts 测试（聚合逻辑、日期处理）
- [ ] 扩展测试覆盖率
  - [ ] models.ts 类型约束测试
  - [ ] defaults.ts 默认值测试

### 组件测试
- [ ] TopNav 组件测试
- [ ] 任务页交互测试（创建/编辑/删除）
- [ ] 计时器页测试（开始/暂停/重置）
- [ ] 记录页测试（表单提交/列表渲染）
- [ ] 总览页测试（数据聚合/图表渲染）

### 集成测试
- [ ] 完整流程测试（创建任务 → 计时 → 保存记录 → 查看总览）
- [ ] localStorage 持久化测试
- [ ] 页面路由导航测试

### 质量检查
- [x] Biome lint 配置与自动化
- [x] TypeScript 严格模式类型检查
- [x] Husky pre-commit/pre-push hooks
- [x] GitHub Actions CI/CD
- [ ] 样式与布局回归测试
- [ ] 性能监控（Core Web Vitals）
- [ ] 首屏加载时间优化

---

## 7. 可扩展能力（未来迭代）
### 数据管理
- [ ] 标签系统（多标签、颜色标记）
- [ ] 分类体系（按科目/项目分组）
- [ ] 智能筛选（按日期/标签/科目）
- [ ] 数据搜索功能

### 目标与规划
- [ ] 长期目标设定（周目标/月目标）
- [ ] 里程碑追踪
- [ ] 学习计划管理
- [ ] 进度可视化

### 通知与提醒
- [ ] 本地提醒（Web Notification API）
- [ ] 学习提醒（定时推送）
- [ ] 目标达成通知
- [ ] 连续学习激励

### 配置中心
- [ ] 主题切换（浅色/深色模式）
- [ ] 显示选项（时间格式、排序方式）
- [ ] 积分规则自定义
- [ ] 数据导出格式配置

---

## 8. 文档与发布
### 项目文档
- [x] README.md 基础说明
- [ ] README 补充内容
  - [ ] 功能演示 GIF/截图
  - [ ] 详细使用说明
  - [ ] FAQ 常见问题
  - [ ] 贡献指南
- [ ] CHANGELOG.md 版本记录
- [x] CLAUDE.md 开发规范（已完善）
- [x] task.md 任务清单（本文档）

### 功能规划
- [ ] 功能路线图文档
  - [ ] 短期计划（v1.2 - 3 个月）
  - [ ] 中期计划（v2.0 - 6 个月）
  - [ ] 长期愿景（v3.0+）
- [ ] 发布流程文档
  - [ ] 版本号规范（Semantic Versioning）
  - [ ] 发布前验收清单
  - [ ] 部署流程说明

---

## 9. 已知问题与改进点

### 高优先级
1. **计时器自动保存**: 当前需手动点击"结束并重置"，应支持后台自动保存
2. **空状态设计**: 首次使用时缺少引导，体验不够友好
3. **数据备份**: 缺少导入/导出功能，数据丢失风险高
4. **错误处理**: 缺少统一的错误提示机制

### 中优先级
5. **积分规则扩展**: RecordEntry 已定义多个字段，但积分计算未使用
6. **移动端优化**: 虽然有响应式，但移动端体验待优化
7. **性能监控**: 缺少首屏加载时间、运行时性能监控
8. **测试覆盖**: 组件测试覆盖率不足

### 低优先级
9. **国际化**: 当前仅支持中文
10. **主题切换**: 仅支持浅色模式
11. **数据分析**: 缺少高级统计功能
12. **社交功能**: 缺少分享、排行榜等

---

## 附录：版本历史

### v1.1 (当前版本 - 2026-01-12)
- ✅ MVP 闭环基本完成
- ✅ 计时 → 记录 → 积分 → 总览流程可用
- ✅ PWA 支持（manifest + sw.js）
- ✅ 基础测试覆盖（lib 层）
- ✅ CI/CD 自动化（Husky + GitHub Actions）

### v1.2 (计划中)
- [ ] 完善空状态/加载态/错误态 UI
- [ ] 实现数据导入/导出
- [ ] 扩展积分规则（质量加成等）
- [ ] 补充 README 演示内容
- [ ] 提升测试覆盖率到 80%+

### v2.0 (规划中)
- [ ] 标签与分类体系
- [ ] 目标与里程碑功能
- [ ] 本地提醒通知
- [ ] 配置中心（主题/规则自定义）
- [ ] 高级数据分析
